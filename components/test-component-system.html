<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLTEACH Component System Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            color: #333;
            margin: 0 0 10px 0;
        }
        
        .header p {
            color: #666;
            margin: 0;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .test-section h2 {
            color: #333;
            margin: 0 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .counter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .controls {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .controls button {
            margin: 5px;
            padding: 8px 16px;
            border: 1px solid #667eea;
            border-radius: 6px;
            background: white;
            color: #667eea;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .controls button:hover {
            background: #667eea;
            color: white;
        }
        
        .log {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        
        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
        }
        
        .log-entry.info { color: #2196F3; }
        .log-entry.success { color: #4CAF50; }
        .log-entry.warning { color: #FF9800; }
        .log-entry.error { color: #F44336; }
        
        #total-display {
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧩 MLTEACH Component System</h1>
            <p>Testing the vanilla JavaScript component system with state management and event handling</p>
        </div>
        
        <div class="test-section">
            <h2>1. Basic Counter Component</h2>
            <p>A simple counter demonstrating the component lifecycle and state management.</p>
            <div id="basic-counter"></div>
        </div>
        
        <div class="test-section">
            <h2>2. Customized Counters</h2>
            <p>Multiple counters with different configurations showing props usage.</p>
            <div class="counter-grid">
                <div id="score-counter"></div>
                <div id="lives-counter"></div>
                <div id="money-counter"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>3. Synchronized Counters</h2>
            <p>Multiple counters that update a total, demonstrating component communication.</p>
            <div id="total-display">Total: 0</div>
            <div class="counter-grid">
                <div id="sync-counter-0"></div>
                <div id="sync-counter-1"></div>
                <div id="sync-counter-2"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>4. Programmatic Control</h2>
            <p>Controlling components programmatically and testing the API.</p>
            <div id="controlled-counter"></div>
            <div class="controls">
                <button onclick="setRandomValue()">Set Random Value</button>
                <button onclick="getValue()">Get Current Value</button>
                <button onclick="testMountUnmount()">Test Mount/Unmount</button>
                <button onclick="clearLog()">Clear Log</button>
            </div>
            <div id="log" class="log"></div>
        </div>
    </div>

    <!-- Include the component system -->
    <script src="base/Component.js"></script>
    <script src="examples/InteractiveCounter.js"></script>
    
    <script>
        // Global variables for testing
        let counters = [];
        let controlledCounter = null;
        let syncCounters = [];
        
        // Logging utility
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        // Initialize components when page loads
        document.addEventListener('DOMContentLoaded', function() {
            log('Initializing MLTEACH Component System...', 'info');
            
            try {
                // 1. Basic Counter
                const basicCounter = new InteractiveCounter({
                    title: 'Basic Counter',
                    onChange: (data) => log(`Basic counter: ${data.action} → ${data.value}`, 'info')
                });
                basicCounter.mount('#basic-counter');
                counters.push(basicCounter);
                log('✓ Basic counter created', 'success');
                
                // 2. Customized Counters
                const scoreCounter = new InteractiveCounter({
                    title: '🎯 Score',
                    initialValue: 1000,
                    step: 100,
                    showReset: true,
                    onChange: (data) => log(`Score: ${data.action} → ${data.value}`, 'info')
                });
                scoreCounter.mount('#score-counter');
                counters.push(scoreCounter);
                
                const livesCounter = new InteractiveCounter({
                    title: '❤️ Lives',
                    initialValue: 3,
                    step: 1,
                    showReset: true,
                    onChange: (data) => {
                        log(`Lives: ${data.action} → ${data.value}`, 'info');
                        if (data.value <= 0) {
                            log('⚠️ Game Over!', 'warning');
                        }
                    }
                });
                livesCounter.mount('#lives-counter');
                counters.push(livesCounter);
                
                const moneyCounter = new InteractiveCounter({
                    title: '💰 Money',
                    initialValue: 50,
                    step: 25,
                    showReset: true,
                    onChange: (data) => log(`Money: ${data.action} → $${data.value}`, 'info')
                });
                moneyCounter.mount('#money-counter');
                counters.push(moneyCounter);
                log('✓ Customized counters created', 'success');
                
                // 3. Synchronized Counters
                const totalDisplay = document.getElementById('total-display');
                
                function updateTotal() {
                    const total = syncCounters.reduce((sum, counter) => sum + counter.getValue(), 0);
                    totalDisplay.textContent = `Total: ${total}`;
                    log(`Total updated: ${total}`, 'info');
                }
                
                ['A', 'B', 'C'].forEach((name, index) => {
                    const counter = new InteractiveCounter({
                        title: `Counter ${name}`,
                        initialValue: index * 5,
                        onChange: (data) => {
                            log(`Counter ${name}: ${data.action} → ${data.value}`, 'info');
                            updateTotal();
                        }
                    });
                    counter.mount(`#sync-counter-${index}`);
                    syncCounters.push(counter);
                    counters.push(counter);
                });
                updateTotal(); // Initial total
                log('✓ Synchronized counters created', 'success');
                
                // 4. Controlled Counter
                controlledCounter = new InteractiveCounter({
                    title: '🎮 Controlled Counter',
                    initialValue: 42,
                    step: 7,
                    showReset: true,
                    onChange: (data) => log(`Controlled: ${data.action} → ${data.value}`, 'info')
                });
                controlledCounter.mount('#controlled-counter');
                counters.push(controlledCounter);
                log('✓ Controlled counter created', 'success');
                
                log('🎉 All components initialized successfully!', 'success');
                
            } catch (error) {
                log(`❌ Error initializing components: ${error.message}`, 'error');
                console.error('Component initialization error:', error);
            }
        });
        
        // Test functions for programmatic control
        function setRandomValue() {
            if (controlledCounter) {
                const randomValue = Math.floor(Math.random() * 200) - 100;
                controlledCounter.setValue(randomValue);
                log(`Set random value: ${randomValue}`, 'success');
            }
        }
        
        function getValue() {
            if (controlledCounter) {
                const value = controlledCounter.getValue();
                log(`Current value: ${value}`, 'success');
            }
        }
        
        function testMountUnmount() {
            if (controlledCounter) {
                if (controlledCounter.isMounted()) {
                    controlledCounter.unmount();
                    log('Counter unmounted', 'warning');
                    setTimeout(() => {
                        controlledCounter.mount('#controlled-counter');
                        log('Counter remounted', 'success');
                    }, 1000);
                } else {
                    controlledCounter.mount('#controlled-counter');
                    log('Counter mounted', 'success');
                }
            }
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '';
            log('Log cleared', 'info');
        }
        
        // Cleanup when page unloads
        window.addEventListener('beforeunload', function() {
            counters.forEach(counter => {
                if (counter.isMounted()) {
                    counter.unmount();
                }
            });
            log('All components cleaned up', 'info');
        });
    </script>
</body>
</html>